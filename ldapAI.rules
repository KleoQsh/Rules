
# LDAP Enumeration - Anonymous bind attempt
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Anonymous bind attempt"; content:"|30 0c 02 01 01 60 07 02 01 03 04 00 80 00|"; sid:1003001; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase1;)

# LDAP Enumeration - Root DSE query
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Root DSE enumeration"; content:"|30 25 02 01 02 63 20 04 00 0a 01 00 0a 01 00 02 01 00 02 01 00 01 01 00 87 0b 6f 62 6a 65 63 74 43 6c 61 73 73|"; sid:1003002; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase1;)

# LDAP Enumeration - All users enumeration
alert tcp any any -> any 389 (msg:"LDAP Enumeration - All users enumeration"; content:"(&(objectClass=user)(objectCategory=person))"; sid:1003003; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Administrative groups
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Administrative groups enum"; content:"(|(cn=Domain Admins)(cn=Enterprise Admins)(cn=Schema Admins))"; sid:1003004; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Computer accounts
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Computer accounts enum"; content:"(&(objectClass=computer)(objectCategory=computer))"; sid:1003005; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Group membership queries
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Group membership enum"; content:"memberOf"; threshold:type both, track by_src, count 5, seconds 30; sid:1003006; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Password policy queries
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Password policy enum"; content:"(objectClass=domainDNS)"; content:"pwdProperties"; distance:0; within:100; sid:1003007; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase1;)

# LDAP Enumeration - User account attributes
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Sensitive user attributes"; content:"userAccountControl"; content:"lastLogon"; distance:0; within:100; sid:1003008; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - GPO enumeration
alert tcp any any -> any 389 (msg:"LDAP Enumeration - GPO enumeration"; content:"objectClass=groupPolicyContainer"; sid:1003009; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - OU structure mapping
alert tcp any any -> any 389 (msg:"LDAP Enumeration - OU structure mapping"; content:"objectClass=organizationalUnit"; threshold:type both, track by_src, count 10, seconds 60; sid:1003010; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase1;)

# LDAP Enumeration - Domain trust enumeration
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Domain trust enum"; content:"objectClass=trustedDomain"; content:"trustType"; distance:0; within:50; sid:1003011; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Privileged user identification
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Privileged user enum"; content:"adminSDHolder"; content:"isCriticalSystemObject"; distance:0; within:100; sid:1003012; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Bulk attribute requests
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Bulk attribute requests"; content:"*"; threshold:type both, track by_src, count 20, seconds 60; sid:1003013; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Forest information gathering
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Forest information gathering"; content:"rootDomainNamingContext"; content:"forestFunctionality"; distance:0; within:100; sid:1003014; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase1;)

# LDAP Enumeration - Schema information gathering
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Schema enumeration"; content:"subschemaSubentry"; sid:1003015; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase1;)

# LDAP Enumeration - Global catalog queries
alert tcp any any -> any 3268 (msg:"LDAP Enumeration - Global catalog queries"; content:"objectClass"; threshold:type both, track by_src, count 5, seconds 30; sid:1003016; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Exchange-specific enumeration
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Exchange objects enum"; content:"objectClass=msExchExchangeServer"; sid:1003017; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - SQL Server enumeration
alert tcp any any -> any 389 (msg:"LDAP Enumeration - SQL Server enum"; content:"servicePrincipalName"; content:"MSSQLSvc"; distance:0; within:50; sid:1003018; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Certificate services enumeration
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Certificate services enum"; content:"objectClass=pKIEnrollmentService"; sid:1003019; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Large result set queries
alert tcp any 389 -> any any (msg:"LDAP Enumeration - Large result set"; dsize:>10000; content:"|30 82|"; sid:1003020; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Kerberos policy enumeration
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Kerberos policy enum"; content:"maxTicketAge"; content:"maxRenewAge"; distance:0; within:100; sid:1003021; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase1;)

# LDAP Enumeration - Site and subnet enumeration
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Site topology enum"; content:"objectClass=site"; content:"objectClass=subnet"; distance:0; within:200; sid:1003022; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase1;)

# LDAP Enumeration - LAPS password attributes
alert tcp any any -> any 389 (msg:"LDAP Enumeration - LAPS password enum"; content:"ms-Mcs-AdmPwd"; content:"ms-Mcs-AdmPwdExpirationTime"; distance:0; within:100; sid:1003023; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Delegated authentication enum
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Delegation enumeration"; content:"msDS-AllowedToDelegateTo"; sid:1003024; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)

# LDAP Enumeration - Unconstrained delegation
alert tcp any any -> any 389 (msg:"LDAP Enumeration - Unconstrained delegation enum"; content:"(&(userAccountControl:1.2.840.113556.1.4.803:=524288))"; sid:1003025; rev:1; classtype:trojan-activity; metadata:attack_target Client_Endpoint, created_at 2024_01_01, deployment Perimeter, tag LDAPEnum_Phase2;)
