alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-BASE: Excessive LDAP queries"; content:"|30|"; depth:1; threshold:type both,track by_src,count 25,seconds 60; flowbits:set,ldap.excessive.query; flowbits:noalert; classtype:attempted-recon; sid:6001001; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-BASE: User enumeration queries"; content:"objectClass=user"; threshold:type both,track by_src,count 8,seconds 45; flowbits:set,ldap.user.enum; flowbits:noalert; classtype:attempted-recon; sid:6001002; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-BASE: Group enumeration queries"; content:"objectClass=group"; threshold:type both,track by_src,count 6,seconds 45; flowbits:set,ldap.group.enum; flowbits:noalert; classtype:attempted-recon; sid:6001003; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-BASE: Computer object enumeration"; content:"objectClass=computer"; threshold:type both,track by_src,count 5,seconds 40; flowbits:set,ldap.computer.enum; flowbits:noalert; classtype:attempted-recon; sid:6001004; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-BASE: Organizational unit enumeration"; content:"objectClass=organizationalUnit"; threshold:type both,track by_src,count 4,seconds 45; flowbits:set,ldap.ou.enum; flowbits:noalert; classtype:attempted-recon; sid:6001005; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-BASE: Domain enumeration queries"; content:"objectClass=domain"; threshold:type both,track by_src,count 3,seconds 30; flowbits:set,ldap.domain.enum; flowbits:noalert; classtype:attempted-recon; sid:6001006; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-ADV: Administrative group queries"; content:"Domain Admins"; threshold:type both,track by_src,count 2,seconds 45; flowbits:set,ldap.admin.group; flowbits:noalert; classtype:attempted-recon; sid:6001007; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-ADV: Service account enumeration"; content:"servicePrincipalName"; threshold:type both,track by_src,count 3,seconds 60; flowbits:set,ldap.service.account; flowbits:noalert; classtype:attempted-recon; sid:6001008; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-ADV: Password policy enumeration"; content:"pwdLastSet"; threshold:type both,track by_src,count 4,seconds 50; flowbits:set,ldap.pwd.policy; flowbits:noalert; classtype:attempted-recon; sid:6001009; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-ADV: Trust relationship enumeration"; content:"trustDirection"; threshold:type both,track by_src,count 2,seconds 40; flowbits:set,ldap.trust.enum; flowbits:noalert; classtype:attempted-recon; sid:6001010; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-ADV: Schema enumeration"; content:"subschema"; threshold:type both,track by_src,count 3,seconds 45; flowbits:set,ldap.schema.enum; flowbits:noalert; classtype:attempted-recon; sid:6001011; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"LDAP-ADV: Wildcard search patterns"; content:"*"; threshold:type both,track by_src,count 10,seconds 60; flowbits:set,ldap.wildcard.search; flowbits:noalert; classtype:attempted-recon; sid:6001012; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"COMBO-LDAP-BASIC: User and group enumeration"; flowbits:isset,ldap.user.enum; flowbits:isset,ldap.group.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:2; sid:6002001; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"COMBO-LDAP-BASIC: Administrative reconnaissance"; flowbits:isset,ldap.admin.group; flowbits:isset,ldap.service.account; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:2; sid:6002002; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"COMBO-LDAP-ADVANCED: Comprehensive AD enumeration"; flowbits:isset,ldap.excessive.query; flowbits:isset,ldap.user.enum; flowbits:isset,ldap.computer.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002003; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"COMBO-LDAP-EXPERT: Advanced AD reconnaissance"; flowbits:isset,ldap.domain.enum; flowbits:isset,ldap.trust.enum; flowbits:isset,ldap.schema.enum; flowbits:isset,ldap.wildcard.search; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002004; rev:1;)
