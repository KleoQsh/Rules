alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOW SCAN] Verifier 1: TCP ACK only"; flags:A; flow:stateless; threshold:type both, track by_src, count 5, seconds 5; sid:200001; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOW SCAN] Verifier 2: Unsolicited ACKs on multiple ports"; flags:A; flow:stateless; threshold:type both, track by_src, count 10, seconds 10; sid:200002; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOW SCAN] COMBO DETECTED"; flags:A; flow:stateless; threshold:type both, track by_src, count 15, seconds 10; classtype:attempted-recon; sid:200003; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[MAIMON SCAN] Verifier 1: FIN+ACK flags"; flags:FA; flow:stateless; sid:200004; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[MAIMON SCAN] Verifier 2: No SYN in handshake"; flags:FA; flow:stateless; threshold:type both, track by_src, count 5, seconds 5; sid:200005; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[MAIMON SCAN] COMBO DETECTED"; flags:FA; flow:stateless; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:200006; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[IDLE SCAN] Verifier 1: IP ID probing pattern"; ip_flags:MF; fragbits:M; fragoffset:0; sid:200007; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[IDLE SCAN] Verifier 2: SYN spoofed from decoy"; flags:S; fragoffset:0; threshold:type both, track by_src, count 5, seconds 5; sid:200008; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[IDLE SCAN] COMBO DETECTED"; fragbits:M; fragoffset:0; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:200009; rev:1;)
alert sctp $EXTERNAL_NET any -> $HOME_NET any (msg:"[SCTP COOKIE SCAN] Verifier 1: SCTP COOKIE-ECHO seen"; sctp_type:COOKIE_ECHO; sid:200013; rev:1;)
alert sctp $EXTERNAL_NET any -> $HOME_NET any (msg:"[SCTP COOKIE SCAN] Verifier 2: ECHO w/o INIT"; sctp_type:COOKIE_ECHO; threshold:type both, track by_src, count 5, seconds 5; sid:200014; rev:1;)
alert sctp $EXTERNAL_NET any -> $HOME_NET any (msg:"[SCTP COOKIE SCAN] COMBO DETECTED"; sctp_type:COOKIE_ECHO; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:200015; rev:1;)
alert sctp $EXTERNAL_NET any -> $HOME_NET any (msg:"[SCTP INIT SCAN] Verifier 1: SCTP INIT sent"; sctp_type:INIT; sid:200010; rev:1;)
alert sctp $EXTERNAL_NET any -> $HOME_NET any (msg:"[SCTP INIT SCAN] Verifier 2: Multiple INITs to multiple ports"; sctp_type:INIT; threshold:type both, track by_src, count 5, seconds 5; sid:200011; rev:1;)
alert sctp $EXTERNAL_NET any -> $HOME_NET any (msg:"[SCTP INIT SCAN] COMBO DETECTED"; sctp_type:INIT; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:200012; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[FRAGMENT SCAN] Verifier 1: IP Fragmented Packet"; fragoffset:>0; sid:300001; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[FRAGMENT SCAN] Verifier 2: Small fragment size"; dsize:<24; fragoffset:>0; threshold:type both, track by_src, count 5, seconds 5; sid:300002; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[FRAGMENT SCAN] COMBO DETECTED"; fragoffset:>0; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:300003; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[MTU SCAN] Verifier 1: Abnormal IP length"; ip_len:<60; sid:300004; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[MTU SCAN] Verifier 2: Multiple small MTU probes"; ip_len:<60; threshold:type both, track by_src, count 5, seconds 5; sid:300005; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[MTU SCAN] COMBO DETECTED"; ip_len:<60; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:300006; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[DATA-LENGTH SCAN] Verifier 1: TCP with excess payload"; dsize:>100; sid:300007; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"[DATA-LENGTH SCAN] Verifier 2: Unusual UDP size"; dsize:>200; threshold:type both, track by_src, count 5, seconds 5; sid:300008; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[DATA-LENGTH SCAN] COMBO DETECTED"; dsize:>150; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:300009; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[TTL SCAN] Verifier 1: Abnormal TTL value"; ttl:<16; sid:300010; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[TTL SCAN] Verifier 2: TTL sweep pattern"; ttl:<32; threshold:type both, track by_src, count 5, seconds 5; sid:300011; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[TTL SCAN] COMBO DETECTED"; ttl:<32; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:300012; rev:1;)
alert ethernet any -> any (msg:"[MAC SPOOFING] Verifier 1: Known spoofed MAC vendor"; ether_src:00:0C:29:xx:xx:xx; sid:300013; rev:1;)
alert ethernet any -> any (msg:"[MAC SPOOFING] Verifier 2: Inconsistent IP-MAC pairing"; ether_src:00:0C:29:xx:xx:xx; threshold:type both, track by_src, count 5, seconds 5; sid:300014; rev:1;)
alert ethernet any -> any (msg:"[MAC SPOOFING] COMBO DETECTED"; ether_src:00:0C:29:xx:xx:xx; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:300015; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[BADSUM SCAN] Verifier 1: Malformed TCP checksum"; tcp_flags:S; invalid_checksum; sid:300016; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"[BADSUM SCAN] Verifier 2: Malformed UDP checksum"; invalid_checksum; threshold:type both, track by_src, count 5, seconds 5; sid:300017; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[BADSUM SCAN] COMBO DETECTED"; invalid_checksum; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:300018; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[DECOY SCAN] Verifier 1: Multiple source IPs in short burst"; detection_filter:track by_dst, count 5, seconds 5; sid:400001; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[DECOY SCAN] Verifier 2: Similar TCP payloads from different IPs"; flags:S; threshold:type both, track by_dst, count 5, seconds 5; sid:400002; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[DECOY SCAN] COMBO DETECTED"; threshold:type both, track by_dst, count 10, seconds 5; classtype:attempted-recon; sid:400003; rev:1;)
alert tcp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"[SOURCE PORT SCAN] Verifier 1: Suspicious TCP from port 53"; flags:S; flow:stateless; sid:400004; rev:1;)
alert tcp $EXTERNAL_NET 20 -> $HOME_NET any (msg:"[SOURCE PORT SCAN] Verifier 2: Spoofed FTP-DATA port"; flags:S; flow:stateless; threshold:type both, track by_src, count 5, seconds 5; sid:400005; rev:1;)
alert tcp $EXTERNAL_NET [20,53,443] -> $HOME_NET any (msg:"[SOURCE PORT SCAN] COMBO DETECTED"; flags:S; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:400006; rev:1;)
alert tcp any any -> $HOME_NET any (msg:"[PROXY SCAN] Verifier 1: HTTP CONNECT to unknown target"; content:"CONNECT"; http_method; sid:400007; rev:1;)
alert tcp any any -> $HOME_NET any (msg:"[PROXY SCAN] Verifier 2: Proxy behavior pattern"; content:"Via:"; http_header; threshold:type both, track by_src, count 5, seconds 5; sid:400008; rev:1;)
alert tcp any any -> $HOME_NET any (msg:"[PROXY SCAN] COMBO DETECTED"; content:"CONNECT"; http_method; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:400009; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"[NSE HTTP] Verifier 1: HTTP User-Agent Nmap"; content:"User-Agent: Mozilla/5.0 (compatible; Nmap)"; http_header; sid:400010; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"[NSE HTTP] Verifier 2: NSE script path probing"; pcre:"/\/scripts\//U"; http_uri; threshold:type both, track by_src, count 5, seconds 5; sid:400011; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"[NSE HTTP] COMBO DETECTED"; content:"User-Agent: Mozilla/5.0 (compatible; Nmap)"; threshold:type both, track by_src, count 10, seconds 5; classtype:web-application-attack; sid:400012; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"[NSE SMB] Verifier 1: SMB negotiation with invalid dialect"; content:"NT LM 0.12"; sid:400013; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"[NSE SMB] Verifier 2: Repeated sessions w/o auth"; content:"SessionSetupAndX"; threshold:type both, track by_src, count 5, seconds 5; sid:400014; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"[NSE SMB] COMBO DETECTED"; content:"SessionSetupAndX"; threshold:type both, track by_src, count 10, seconds 5; classtype:protocol-command-decode; sid:400015; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"[NSE DNS] Verifier 1: High frequency DNS queries"; threshold:type both, track by_src, count 10, seconds 5; sid:400016; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"[NSE DNS] Verifier 2: Pattern of DNS subdomain fuzzing"; content:"example."; threshold:type both, track by_src, count 5, seconds 5; sid:400017; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"[NSE DNS] COMBO DETECTED"; content:"example."; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:400018; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Masscan] Verifier 1: TCP SYN flood on many ports"; flags:S; flow:stateless; threshold:type both, track by_src, count 50, seconds 2; sid:500001; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[Masscan] Verifier 2: Same TTL across many ports"; ttl:254; threshold:type both, track by_src, count 50, seconds 2; sid:500002; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[Masscan] COMBO DETECTED"; ttl:254; threshold:type both, track by_src, count 100, seconds 3; classtype:attempted-recon; sid:500003; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[ZMap] Verifier 1: TCP SYN with identical ID values"; flags:S; ip_id:54321; flow:stateless; sid:500004; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[ZMap] Verifier 2: Uniform scanning pattern"; flags:S; threshold:type both, track by_src, count 50, seconds 2; sid:500005; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[ZMap] COMBO DETECTED"; ip_id:54321; threshold:type both, track by_src, count 100, seconds 3; classtype:attempted-recon; sid:500006; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Netcat] Verifier 1: Unusual short TCP payload"; dsize:<5; flags:PA; sid:500007; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Netcat] Verifier 2: Manual port sweep detected"; flags:S; threshold:type both, track by_src, count 5, seconds 10; sid:500008; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Netcat] COMBO DETECTED"; flags:S; dsize:<5; threshold:type both, track by_src, count 10, seconds 10; classtype:attempted-recon; sid:500009; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Hping3] Verifier 1: Manual TCP flag crafting"; flags:SFPU; flow:stateless; sid:500010; rev:1;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Hping3] Verifier 2: Burst of ICMP ECHO requests"; itype:8; threshold:type both, track by_src, count 10, seconds 2; sid:500011; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"[Hping3] COMBO DETECTED"; fragoffset:0; threshold:type both, track by_src, count 15, seconds 5; classtype:attempted-recon; sid:500012; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[VulnScan] Verifier 1: Known scanner User-Agent"; content:"User-Agent: Nessus"; http_header; sid:500013; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[VulnScan] Verifier 2: Multiple 404/500 probes"; flow:to_server; threshold:type both, track by_src, count 10, seconds 5; sid:500014; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[VulnScan] COMBO DETECTED"; content:"User-Agent: Nessus"; threshold:type both, track by_src, count 15, seconds 5; classtype:web-application-attack; sid:500015; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Scanrand] Verifier 1: SYN with no 3-way follow-up"; flags:S; flow:stateless; sid:500016; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Scanrand] Verifier 2: Low TTL + high spread"; ttl:<32; threshold:type both, track by_src, count 20, seconds 3; sid:500017; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Scanrand] COMBO DETECTED"; flags:S; ttl:<32; threshold:type both, track by_src, count 30, seconds 3; classtype:attempted-recon; sid:500018; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Unicornscan] Verifier 1: SYN packets on wide port range"; flags:S; flow:stateless; threshold:type both, track by_src, count 50, seconds 2; sid:500019; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Unicornscan] Verifier 2: TCP with uncommon IP ID"; ip_id:0; sid:500020; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Unicornscan] COMBO DETECTED"; ip_id:0; threshold:type both, track by_src, count 100, seconds 2; classtype:attempted-recon; sid:500021; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Amap] Verifier 1: App scan signature in payload"; content:"amap v5"; sid:500022; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Amap] Verifier 2: Repeated connections on app ports"; flow:established; threshold:type both, track by_src, count 5, seconds 5; sid:500023; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"[Amap] COMBO DETECTED"; content:"amap v5"; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:500024; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"[Fierce] Verifier 1: DNS brute-force pattern"; content:"A?"; threshold:type both, track by_src, count 10, seconds 5; sid:500028; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"[Fierce] Verifier 2: Subdomain sweep behavior"; content:".corp"; sid:500029; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"[Fierce] COMBO DETECTED"; content:".corp"; threshold:type both, track by_src, count 10, seconds 5; classtype:attempted-recon; sid:500030; rev:1;)
