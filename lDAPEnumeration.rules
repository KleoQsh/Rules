alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Anonymous Bind Attempt"; content:"|30|"; content:"|02 01 01|"; content:"|60|"; distance:0; within:10; threshold:type both,track by_src,count 2,seconds 60; flowbits:set,ldap.anonymous.bind; flowbits:noalert; classtype:attempted-recon; sid:6001001; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Simple Bind with Empty Password"; content:"|30|"; content:"|02 01 01|"; content:"|60|"; content:"|80 00|"; distance:0; within:20; threshold:type both,track by_src,count 2,seconds 60; flowbits:set,ldap.empty.password; flowbits:noalert; classtype:attempted-recon; sid:6001002; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: User Enumeration via Filter"; content:"(objectClass=user)"; threshold:type both,track by_src,count 5,seconds 90; flowbits:set,ldap.user.enum; flowbits:noalert; classtype:attempted-recon; sid:6001003; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Group Enumeration"; content:"(objectClass=group)"; threshold:type both,track by_src,count 5,seconds 90; flowbits:set,ldap.group.enum; flowbits:noalert; classtype:attempted-recon; sid:6001004; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: SPN Enumeration"; content:"servicePrincipalName"; threshold:type both,track by_src,count 3,seconds 60; flowbits:set,ldap.spn.enum; flowbits:noalert; classtype:attempted-recon; sid:6001005; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Password Policy Query"; content:"pwdLastSet"; threshold:type both,track by_src,count 3,seconds 60; flowbits:set,ldap.pwd.policy; flowbits:noalert; classtype:attempted-recon; sid:6001006; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: High Volume Search Requests"; threshold:type both,track by_src,count 10,seconds 120; flowbits:set,ldap.high.volume; flowbits:noalert; classtype:attempted-recon; sid:6001007; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Unusual Search Filter"; content:"(objectClass=*)"; threshold:type both,track by_src,count 5,seconds 60; flowbits:set,ldap.unusual.filter; flowbits:noalert; classtype:attempted-recon; sid:6001008; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Null Base DN Query"; content:"|04 00|"; within:10; threshold:type both,track by_src,count 3,seconds 60; flowbits:set,ldap.null.dn; flowbits:noalert; classtype:attempted-recon; sid:6001009; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Repeated Failed Binds"; content:"|30|"; content:"|02 01 01|"; content:"|6a|"; distance:0; within:20; threshold:type both,track by_src,count 5,seconds 60; flowbits:set,ldap.failed.binds; flowbits:noalert; classtype:attempted-recon; sid:6001010; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Large Result Set Request"; dsize:>1000; threshold:type both,track by_src,count 3,seconds 60; flowbits:set,ldap.large.result; flowbits:noalert; classtype:attempted-recon; sid:6001011; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Unusual Attribute Request"; content:"userPassword"; threshold:type both,track by_src,count 3,seconds 60; flowbits:set,ldap.unusual.attr; flowbits:noalert; classtype:attempted-recon; sid:6001012; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Timing Anomaly"; detection_filter:track by_src,count 5,seconds 30; flowbits:set,ldap.timing.anomaly; flowbits:noalert; classtype:attempted-recon; sid:6001013; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Automated Tool Signature"; content:"|30|"; content:"|02 01 01|"; content:"|63|"; distance:0; within:20; threshold:type both,track by_src,count 2,seconds 30; flowbits:set,ldap.automated.tool; flowbits:noalert; classtype:attempted-recon; sid:6001014; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"LDAP-BASE: Cross-Domain Query"; content:"dc="; content:"dc="; distance:0; within:50; threshold:type both,track by_src,count 2,seconds 60; flowbits:set,ldap.cross.domain; flowbits:noalert; classtype:attempted-recon; sid:6001015; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Anonymous Bind and User Enum"; flowbits:isset,ldap.anonymous.bind; flowbits:isset,ldap.user.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002001; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Empty Password and SPN Enum"; flowbits:isset,ldap.empty.password; flowbits:isset,ldap.spn.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002002; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: High Volume and Unusual Filter"; flowbits:isset,ldap.high.volume; flowbits:isset,ldap.unusual.filter; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002003; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Failed Binds and Timing Anomaly"; flowbits:isset,ldap.failed.binds; flowbits:isset,ldap.timing.anomaly; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002004; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Automated Tool and SPN Enum"; flowbits:isset,ldap.automated.tool; flowbits:isset,ldap.spn.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002005; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Cross-Domain and Group Enum"; flowbits:isset,ldap.cross.domain; flowbits:isset,ldap.group.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002006; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Large Result and Unusual Attr"; flowbits:isset,ldap.large.result; flowbits:isset,ldap.unusual.attr; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002007; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Null DN and High Volume"; flowbits:isset,ldap.null.dn; flowbits:isset,ldap.high.volume; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002008; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Password Policy and User Enum"; flowbits:isset,ldap.pwd.policy; flowbits:isset,ldap.user.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002009; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Failed Binds and Automated Tool"; flowbits:isset,ldap.failed.binds; flowbits:isset,ldap.automated.tool; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002010; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Timing Anomaly and Unusual Filter"; flowbits:isset,ldap.timing.anomaly; flowbits:isset,ldap.unusual.filter; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002011; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: SPN Enum and Group Enum"; flowbits:isset,ldap.spn.enum; flowbits:isset,ldap.group.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002012; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Cross-Domain and High Volume"; flowbits:isset,ldap.cross.domain; flowbits:isset,ldap.high.volume; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002013; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Null DN and Unusual Attr"; flowbits:isset,ldap.null.dn; flowbits:isset,ldap.unusual.attr; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002014; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"COMBO-LDAP: Automated Tool and High Volume"; flowbits:isset,ldap.automated.tool; flowbits:isset,ldap.high.volume; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:6002015; rev:2;)
