alert tcp 192.168.1.X any -> 192.168.1.Y 389 (msg:"Lab LDAP Recon: Usernames enumeration"; flow:established,to_server; content:"sAMAccountName"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:100001; rev:1;)
alert tcp 192.168.1.X any -> 192.168.1.Y 389 (msg:"Lab LDAP Recon: Display Name enumeration"; flow:established,to_server; content:"displayName"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:100002; rev:1;)
alert tcp 192.168.1.X any -> 192.168.1.Y 389 (msg:"Lab LDAP Recon: Email enumeration"; flow:established,to_server; content:"mail"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:100003; rev:1;)
alert tcp 192.168.1.X any -> 192.168.1.Y 389 (msg:"Lab LDAP Recon: Account status"; flow:established,to_server; content:"userAccountControl"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:100004; rev:1;)
alert tcp 192.168.1.X any -> 192.168.1.Y 389 (msg:"Lab LDAP Recon: SPN enumeration"; flow:established,to_server; content:"servicePrincipalName"; nocase; dsize:>200; threshold:type both, track by_src, count 3, seconds 60; sid:100005; rev:1;)
alert tcp 192.168.1.X any -> 192.168.1.Y 389 (msg:"Lab LDAP Recon: Privileged group enumeration"; flow:established,to_server; content:"(&(objectClass=group)(|(cn=Domain Admins)(cn=Enterprise Admins)))"; nocase; dsize:>300; threshold:type both, track by_src, count 3, seconds 60; sid:100006; rev:1;)
alert tcp 192.168.1.X any -> 192.168.1.Y 389 (msg:"Lab LDAP Recon: Nested group enumeration"; flow:established,to_server; content:"memberOf:1.2.840.113556.1.4.1941"; nocase; dsize:>200; threshold:type both, track by_src, count 3, seconds 60; sid:100007; rev:1;)
alert tcp 192.168.1.X any -> 192.168.1.Y 389 (msg:"Lab LDAP Recon: OU enumeration"; flow:established,to_server; content:"organizationalUnit"; nocase; dsize:>200; threshold:type both, track by_src, count 3, seconds 60; sid:100008; rev:1;)
alert tcp 192.168.1.X any -> 192.168.1.Y 389 (msg:"Lab LDAP Recon: Computer enumeration"; flow:established,to_server; content:"objectClass=computer"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:100009; rev:1;)
