alert tcp 192.168.1.0/24 any -> any 445 (msg:"PS-BASE: SMB password spray pattern"; content:"STATUS_LOGON_FAILURE"; threshold:type both,track by_src,count 15,seconds 1800; flowbits:set,ps.smb.spray; flowbits:noalert; classtype:attempted-admin; sid:7001001; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"PS-BASE: LDAP authentication spray"; content:"invalidCredentials"; threshold:type both,track by_src,count 12,seconds 1500; flowbits:set,ps.ldap.spray; flowbits:noalert; classtype:attempted-admin; sid:7001002; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"PS-BASE: Kerberos password spray"; content:"KDC_ERR_PREAUTH_FAILED"; threshold:type both,track by_src,count 10,seconds 1200; flowbits:set,ps.kerb.spray; flowbits:noalert; classtype:attempted-admin; sid:7001003; rev:1;)
alert tcp 192.168.1.0/24 any -> any [80,443] (msg:"PS-BASE: Web authentication spray"; content:"401 Unauthorized"; threshold:type both,track by_src,count 20,seconds 2400; flowbits:set,ps.web.spray; flowbits:noalert; classtype:attempted-admin; sid:7001004; rev:1;)
alert tcp 192.168.1.0/24 any -> any 22 (msg:"PS-BASE: SSH password spray"; content:"Authentication failure"; threshold:type both,track by_src,count 8,seconds 1200; flowbits:set,ps.ssh.spray; flowbits:noalert; classtype:attempted-admin; sid:7001005; rev:1;)
alert tcp 192.168.1.0/24 any -> any 3389 (msg:"PS-BASE: RDP password spray"; threshold:type both,track by_src,count 6,seconds 900; flowbits:set,ps.rdp.spray; flowbits:noalert; classtype:attempted-admin; sid:7001006; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"PS-ADV: Cross-protocol spray pattern"; threshold:type both,track by_src,count 25,seconds 3600; flowbits:set,ps.cross.protocol; flowbits:noalert; classtype:attempted-admin; sid:7001007; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"PS-ADV: Slow spray timing pattern"; detection_filter:track by_src,count 5,seconds 600; flowbits:set,ps.slow.timing; flowbits:noalert; classtype:attempted-admin; sid:7001008; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"PS-ADV: Distributed spray coordination"; threshold:type both,track by_src,count 30,seconds 7200; flowbits:set,ps.distributed; flowbits:noalert; classtype:attempted-admin; sid:7001009; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"PS-ADV: Password spray with lockout evasion"; threshold:type both,track by_src,count 18,seconds 4800; flowbits:set,ps.lockout.evasion; flowbits:noalert; classtype:attempted-admin; sid:7001010; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"PS-ADV: Targeted user spray pattern"; threshold:type both,track by_src,count 12,seconds 2400; flowbits:set,ps.targeted.users; flowbits:noalert; classtype:attempted-admin; sid:7001011; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"COMBO-PS-BASIC: SMB and LDAP spray attack"; flowbits:isset,ps.smb.spray; flowbits:isset,ps.ldap.spray; threshold:type limit,track by_src,count 1,seconds 3600; classtype:attempted-admin; priority:2; sid:7002001; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"COMBO-PS-BASIC: Kerberos and web spray"; flowbits:isset,ps.kerb.spray; flowbits:isset,ps.web.spray; threshold:type limit,track by_src,count 1,seconds 3600; classtype:attempted-admin; priority:2; sid:7002002; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"COMBO-PS-ADVANCED: Multi-protocol password spray"; flowbits:isset,ps.cross.protocol; flowbits:isset,ps.slow.timing; flowbits:isset,ps.lockout.evasion; threshold:type limit,track by_src,count 1,seconds 3600; classtype:attempted-admin; priority:1; sid:7002003; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"COMBO-PS-EXPERT: Coordinated spray campaign"; flowbits:isset,ps.smb.spray; flowbits:isset,ps.kerb.spray; flowbits:isset,ps.distributed; flowbits:isset,ps.targeted.users; threshold:type limit,track by_src,count 1,seconds 3600; classtype:attempted-admin; priority:1; sid:7002004; rev:1;)
