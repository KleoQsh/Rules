alert tcp 192.168.1.1 any -> $HOME_NET !22,23,80,443,53,135,139,445,1433,3306,3389,5060,5061 (msg:"ET SCAN Internal TCP SYN Scan Probe - Uncommon Port"; flags:S; flow:not_established; threshold: type threshold, track by_src, count 10, seconds 30; sid:1001001; rev:1;)
alert tcp 192.168.1.1 any -> $HOME_NET 1:1024 (msg:"ET SCAN Internal TCP SYN Scan Probe - Common Port Range"; flags:S; flow:not_established; threshold: type threshold, track by_src, count 20, seconds 20; sid:1001002; rev:1;)
alert tcp 192.168.1.1 any -> $HOME_NET any (msg:"ET SCAN INTERNAL TCP SYN SCAN ATTACK FROM GATEWAY"; flags:S; flow:not_established; detection_filter: track by_src, count 15, seconds 15; sid:1001099; rev:1;)
alert udp 192.168.1.1 any -> $HOME_NET !53,67,68,123,161,500,4500,5060 (msg:"ET SCAN Internal UDP Scan Probe - Uncommon Port"; flow:not_established; threshold: type threshold, track by_src, count 8, seconds 30; sid:1002001; rev:1;)
alert udp 192.168.1.1 any -> $HOME_NET 1:1000 (msg:"ET SCAN Internal UDP Scan Probe - Common Port Range"; flow:not_established; threshold: type threshold, track by_src, count 15, seconds 20; sid:1002002; rev:1;)
alert udp 192.168.1.1 any -> $HOME_NET 53 (msg:"ET SCAN Internal DNS Version Probe"; content:"version|00 00 ff 00 01|bind|00|"; fast_pattern; threshold: type threshold, track by_src, count 3, seconds 60; sid:1002003; rev:1;)
alert udp 192.168.1.1 any -> $HOME_NET any (msg:"ET SCAN INTERNAL UDP SCAN ATTACK FROM GATEWAY"; flow:not_established; detection_filter: track by_src, count 10, seconds 15; sid:1002099; rev:1;)# --- Detector Rules: Abnormal TCP packets ---
alert tcp 192.168.1.1 any -> $HOME_NET any (msg:"ET SCAN Internal TCP FIN Scan Probe"; flags:F; flow:not_established; threshold: type threshold, track by_src, count 5, seconds 60; sid:1003001; rev:1;)
alert tcp 192.168.1.1 any -> $HOME_NET any (msg:"ET SCAN Internal TCP NULL Scan Probe"; flags:0; flow:not_established; threshold: type threshold, track by_src, count 5, seconds 60; sid:1003002; rev:1;)
alert tcp 192.168.1.1 any -> $HOME_NET any (msg:"ET SCAN Internal TCP Xmas Scan Probe"; flags:FPU; flow:not_established; threshold: type threshold, track by_src, count 5, seconds 60; sid:1003003; rev:1;)
alert tcp 192.168.1.1 any -> $HOME_NET any (msg:"ET SCAN INTERNAL STEALTH SCAN ATTACK FROM GATEWAY"; flow:not_established; detection_filter: track by_src, count 3, seconds 30; sid:1003099; rev:1;)# --- Detector Rules: Various ICMP types used for discovery ---
alert icmp 192.168.1.1 any -> $HOME_NET any (msg:"ET SCAN Internal ICMP Address Mask Request"; itype:17; icode:0; threshold: type threshold, track by_src, count 3, seconds 120; sid:1004001; rev:1;)
alert icmp 192.168.1.1 any -> $HOME_NET any (msg:"ET SCAN Internal ICMP Timestamp Request"; itype:13; icode:0; threshold: type threshold, track by_src, count 3, seconds 120; sid:1004002; rev:1;)
alert icmp 192.168.1.1 any -> $HOME_NET any (msg:"ET SCAN Internal ICMP Information Request"; itype:15; icode:0; threshold: type threshold, track by_src, count 3, seconds 120; sid:1004003; rev:1;)
alert arp any any -> any any (msg:"ET SCAN Possible ARP Scan Probe"; arp.opcode: 1; threshold: type threshold, track by_src, count 20, seconds 10; sid:1004004; rev:1;)
alert icmp 192.168.1.1 any -> $HOME_NET any (msg:"ET SCAN INTERNAL ICMP DISCOVERY SCAN FROM GATEWAY"; detection_filter: track by_src, count 5, seconds 60; sid:1004099; rev:1;)
