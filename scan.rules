################################################################################
#  1. Nmap SYN scan (default, multiple ports)
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,22,23,80,443,3389] (
    msg:"PORTSCAN: Nmap SYN Scan"; flow:stateless; flags:S;
    tcpopts:!mss,!sackOK,!wscale; ip_proto:6; tos:0x00; ttl:<64;
    dsize:>0; fragbits:!MFF; detection_filter:track by_src, count 20, seconds 5;
    reference:url,nmap.org; classtype:attempted-recon; priority:2;
    sid:2500001; rev:1;
)

################################################################################
#  2. Nmap Connect scan (full handshake, multiple ports)
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,22,23,80,443,3389] (
    msg:"PORTSCAN: Nmap Connect Scan"; flow:to_server,established; flags:S,A;
    tcpopts:!mss,!nop,!wscale; ip_proto:6; tos:0x00; ttl:<64;
    dsize:>40; fragbits:!MFF; detection_filter:track by_src, count 15, seconds 5;
    reference:url,nmap.org; classtype:attempted-recon; priority:2;
    sid:2500002; rev:1;
)

################################################################################
#  3. Nmap UDP scan (common ports)
alert udp $EXTERNAL_NET any -> $HOME_NET [53,69,123,161] (
    msg:"PORTSCAN: Nmap UDP Scan"; ip_proto:17; tos:0x00; ttl:<128;
    dsize:>0; fragbits:!MFF; detection_filter:track by_src, count 30, seconds 10;
    classtype:attempted-recon; priority:2; sid:2500003; rev:1;
)

################################################################################
#  4. Nmap XMAS scan
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: Nmap XMAS Scan"; flow:stateless; flags:FPU;
    tcpopts:!mss,!wscale; ip_proto:6; tos:0x00; ttl:<64;
    dsize:>0; fragbits:!MFF; detection_filter:track by_src, count 10, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500004; rev:1;
)

################################################################################
#  5. Nmap NULL scan
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: Nmap NULL Scan"; flow:stateless; flags:0; tcpopts:!mss;
    ip_proto:6; tos:0x00; ttl:<64; dsize:>0; fragbits:!MFF;
    detection_filter:track by_src, count 10, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500005; rev:1;
)

################################################################################
#  6. Nmap FIN scan
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: Nmap FIN Scan"; flow:stateless; flags:F;
    tcpopts:!mss,!wscale; ip_proto:6; tos:0x00; ttl:<64;
    dsize:>0; fragbits:!MFF; detection_filter:track by_src, count 10, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500006; rev:1;
)

################################################################################
#  7. Nmap ACK scan
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: Nmap ACK Scan"; flow:stateless; flags:A;
    tcpopts:!mss,!nop; ip_proto:6; tos:0x00; ttl:<64;
    dsize:>40; fragbits:!MFF; detection_filter:track by_src, count 15, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500007; rev:1;
)

################################################################################
#  8. Nmap Window scan (window size > 100)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: Nmap Window Scan"; flow:stateless; flags:A;
    byte_test:2,>,100,window; tcpopts:!mss,!wscale; ip_proto:6;
    tos:0x00; ttl:<64; dsize:>0; fragbits:!MFF;
    detection_filter:track by_src, count 15, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500008; rev:1;
)

################################################################################
#  9. Nmap Maimon scan (FIN+PSH)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: Nmap Maimon Scan"; flow:stateless; flags:FP;
    tcpopts:!mss,!wscale; ip_proto:6; tos:0x00; ttl:<64;
    dsize:>0; fragbits:!MFF; detection_filter:track by_src, count 10, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500009; rev:1;
)

################################################################################
# 10. Masscan highâ€‘speed SYN (all TCP ports)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: Masscan High-Speed SYN"; flow:stateless; flags:S;
    tcpopts:!mss,!nop; ip_proto:6; tos:0x00; ttl:<64;
    dsize:>0; fragbits:!MFF; detection_filter:track by_src, count 200, seconds 2;
    classtype:attempted-recon; priority:1; sid:2500010; rev:1;
)

################################################################################
# 11. ZMap SYN scan (payload > 60)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: ZMap SYN Scan"; flow:stateless; flags:S;
    dsize:>60; tcpopts:!mss,!nop; ip_proto:6; tos:0x00; ttl:<64;
    fragbits:!MFF; detection_filter:track by_src, count 50, seconds 5;
    classtype:attempted-recon; priority:1; sid:2500011; rev:1;
)

################################################################################
# 12. Unicornscan SYN (stateless)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: Unicornscan SYN"; flow:stateless; flags:S;
    tcpopts:!mss,!wscale; ip_proto:6; tos:0x00; ttl:<64; dsize:>0;
    fragbits:!MFF; detection_filter:track by_src, count 25, seconds 5;
    classtype:attempted-recon; priority:1; sid:2500012; rev:1;
)

################################################################################
# 13. hping3 TCP ACK scan
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: hping3 ACK Scan"; flow:stateless; flags:A;
    tcpopts:!mss,!nop; ip_proto:6; tos:0x00; ttl:<64; dsize:0;
    fragbits:!MFF; detection_filter:track by_src, count 20, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500013; rev:1;
)

################################################################################
# 14. hping3 TCP SYN scan (dsize 0)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: hping3 SYN Scan Zero Payload"; flow:stateless; flags:S;
    dsize:0; tcpopts:!mss,!nop; ip_proto:6; tos:0x00; ttl:<64;
    fragbits:!MFF; detection_filter:track by_src, count 20, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500014; rev:1;
)

################################################################################
# 15. hping3 UDP scan (zero payload)
alert udp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: hping3 UDP Scan Zero Payload"; dsize:0; ip_proto:17;
    tos:0x00; ttl:<128; fragbits:!MFF; detection_filter:track by_src, count 30, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500015; rev:1;
)

################################################################################
# 16. fping ICMP Echo sweep (fragt bits ignored)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: fping ICMP Sweep"; itype:8; icode:0; tos:0x00; ttl:<128;
    fragbits:!MFF; detection_filter:track by_src, count 20, seconds 10;
    classtype:attempted-recon; priority:2; sid:2500016; rev:1;
)

################################################################################
# 17. Advanced FIN+PSH scan (THC-Scan style)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: THC FIN+PSH Scan"; flow:stateless; flags:FP;
    tcpopts:!mss,!wscale; ip_proto:6; tos:0x00; ttl:<64; dsize:>0;
    fragbits:!MFF; detection_filter:track by_src, count 12, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500017; rev:1;
)

################################################################################
# 18. Fragmented packet scan (any proto)
alert ip $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: Fragmented Packet Scan"; fragbits:M; tos:0x00; ttl:<128;
    detection_filter:track by_src, count 15, seconds 5;
    classtype:attempted-recon; priority:3; sid:2500018; rev:1;
)

################################################################################
# 19. ICMP timestamp request sweep
alert icmp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: ICMP Timestamp Request Sweep"; itype:13; icode:0;
    tos:0x00; ttl:<128; detection_filter:track by_src, count 10, seconds 10;
    classtype:attempted-recon; priority:3; sid:2500019; rev:1;
)

################################################################################
# 20. ARP broadcast sweep (Ethernet)
alert ethernet any any -> any any (
    msg:"PORTSCAN: ARP Broadcast Sweep"; eth_type:0x806;
    detection_filter:track by_src, count 25, seconds 10;
    classtype:attempted-recon; priority:3; sid:2500020; rev:1;
)

################################################################################
# 21. SCTP INIT chunk scan
alert sctp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: SCTP INIT Chunk Scan"; sctp_sinit_chunks; tos:0x00; ttl:<64;
    detection_filter:track by_src, count 10, seconds 5;
    classtype:attempted-recon; priority:3; sid:2500021; rev:1;
)

################################################################################
# 22. RPC Portmapper probe (TCP/111)
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 (
    msg:"PORTSCAN: RPC Portmapper Probe"; flow:stateless; flags:S;
    tos:0x00; ttl:<64; detection_filter:track by_src, count 5, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500022; rev:1;
)

################################################################################
# 23. SNMP walk attempt (UDP/161)
alert udp $EXTERNAL_NET any -> $HOME_NET 161 (
    msg:"PORTSCAN: SNMP Walk Attempt"; dsize:>50; tos:0x00; ttl:<128;
    detection_filter:track by_src, count 5, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500023; rev:1;
)

################################################################################
# 24. NetBIOS name scan (UDP/137)
alert udp $EXTERNAL_NET any -> $HOME_NET 137 (
    msg:"PORTSCAN: NetBIOS Name Scan"; dsize:>0; tos:0x00; ttl:<128;
    detection_filter:track by_src, count 10, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500024; rev:1;
)

################################################################################
# 25. DHCP discover flood (UDP/67)
alert udp $EXTERNAL_NET any -> $HOME_NET 67 (
    msg:"PORTSCAN: DHCP Discover Flood"; dsize:>200; tos:0x00; ttl:<128;
    detection_filter:track by_src, count 20, seconds 5;
    classtype:attempted-recon; priority:3; sid:2500025; rev:1;
)

################################################################################
# 26. SMB port scan (TCP/445)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (
    msg:"PORTSCAN: SMB Port Scan"; flow:stateless; flags:S; tos:0x00; ttl:<64;
    detection_filter:track by_src, count 8, seconds 5;
    classtype:attempted-recon; priority:2; sid:2500026; rev:1;
)

################################################################################
# 27. HTTP OPTIONS method scan (any port)
alert http $EXTERNAL_NET any -> $HOME_NET any (
    msg:"PORTSCAN: HTTP OPTIONS Scan"; flow:to_server,established;
    http_method; content:"OPTIONS"; detection_filter:track by_src, count 10, seconds 10;
    classtype:attempted-recon; priority:2; sid:2500027; rev:1;
)

################################################################################
# 28. Kafka broker scan (TCP/9092)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9092 (
    msg:"PORTSCAN: Kafka Broker Scan"; flow:stateless; flags:S; tos:0x00; ttl:<64;
    detection_filter:track by_src, count 5, seconds 5;
    classtype:attempted-recon; priority:3; sid:2500028; rev:1;
)

################################################################################
# 29. Redis scan (TCP/6379)
alert tcp $EXTERNAL_NET any -> $HOME_NET 6379 (
    msg:"PORTSCAN: Redis Service Scan"; flow:stateless; flags:S; tos:0x00; ttl:<64;
    detection_filter:track by_src, count 5, seconds 5;
    classtype:attempted-recon; priority:3; sid:2500029; rev:1;
)

################################################################################
# 30. Elasticsearch scan (TCP/9200)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9200 (
    msg:"PORTSCAN: Elasticsearch Cluster Scan"; flow:stateless; flags:S; tos:0x00; ttl:<64;
    detection_filter:track by_src, count 5, seconds 5;
    classtype:attempted-recon; priority:3; sid:2500030; rev:1;
)

