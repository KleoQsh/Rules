alert tcp 192.168.1.0/24 any -> any 88 (msg:"KERB-BASE: TGS request for service account"; content:"|a0 03 02 01 05|"; content:"|a1 03 02 01 16|"; threshold:type both,track by_src,count 3,seconds 60; flowbits:set,kerb.tgs.request; flowbits:noalert; classtype:attempted-admin; sid:5001001; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"KERB-BASE: RC4 encryption in TGS request"; content:"|a0 03 02 01 05|"; content:"|17|"; distance:0; within:50; threshold:type both,track by_src,count 2,seconds 45; flowbits:set,kerb.rc4.request; flowbits:noalert; classtype:attempted-admin; sid:5001002; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"KERB-BASE: Multiple service ticket requests"; content:"krbtgt"; threshold:type both,track by_src,count 5,seconds 90; flowbits:set,kerb.multiple.tgs; flowbits:noalert; classtype:attempted-admin; sid:5001003; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"KERB-BASE: Service principal enumeration"; content:"HTTP/"; threshold:type both,track by_src,count 4,seconds 60; flowbits:set,kerb.spn.enum; flowbits:noalert; classtype:attempted-admin; sid:5001004; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"KERB-BASE: Unusual service ticket timing"; content:"|a0 03 02 01 05|"; detection_filter:track by_src,count 3,seconds 30; flowbits:set,kerb.timing.anomaly; flowbits:noalert; classtype:attempted-admin; sid:5001005; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"KERB-ADV: LDAP SPN query for Kerberoasting"; content:"servicePrincipalName"; threshold:type both,track by_src,count 3,seconds 45; flowbits:set,kerb.ldap.spn; flowbits:noalert; classtype:attempted-admin; sid:5001006; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"KERB-ADV: Automated Kerberoasting tool signature"; content:"|a0 03 02 01 05|"; content:"|a1 03 02 01 16|"; content:"|a2|"; distance:0; within:100; threshold:type both,track by_src,count 2,seconds 30; flowbits:set,kerb.automated.tool; flowbits:noalert; classtype:attempted-admin; sid:5001007; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"KERB-ADV: Cross-domain TGS requests"; content:"krbtgt"; content:"@"; distance:0; within:50; threshold:type both,track by_src,count 2,seconds 60; flowbits:set,kerb.cross.domain; flowbits:noalert; classtype:attempted-admin; sid:5001008; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"KERB-ADV: High-privilege service targeting"; content:"HOST/"; threshold:type both,track by_src,count 2,seconds 45; flowbits:set,kerb.high.priv; flowbits:noalert; classtype:attempted-admin; sid:5001009; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"COMBO-KERB-BASIC: TGS and SPN enumeration"; flowbits:isset,kerb.tgs.request; flowbits:isset,kerb.ldap.spn; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:2; sid:5002001; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"COMBO-KERB-BASIC: RC4 and multiple requests"; flowbits:isset,kerb.rc4.request; flowbits:isset,kerb.multiple.tgs; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:2; sid:5002002; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"COMBO-KERB-ADVANCED: Automated Kerberoasting attack"; flowbits:isset,kerb.automated.tool; flowbits:isset,kerb.spn.enum; flowbits:isset,kerb.timing.anomaly; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002003; rev:1;)
alert tcp 192.168.1.0/24 any -> any 88 (msg:"COMBO-KERB-EXPERT: Advanced Kerberoasting campaign"; flowbits:isset,kerb.tgs.request; flowbits:isset,kerb.rc4.request; flowbits:isset,kerb.ldap.spn; flowbits:isset,kerb.high.priv; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002004; rev:1;)
