
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"PASSWORD SPRAYING - SSH multiple failed logins with unique users"; flow:to_server,established; content:"Invalid user"; nocase; threshold:type both, track by_src, count 8, seconds 900; classtype:attempted-admin; sid:2210001; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"PASSWORD SPRAYING - SSH high fail rate per user"; flow:to_server,established; content:"Failed password for"; nocase; threshold:type both, track by_src, count 5, seconds 300; classtype:attempted-admin; sid:2210002; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"PASSWORD SPRAYING - RDP multiple failed login attempts"; flow:to_server,established; content:"Authentication failed"; nocase; threshold:type both, track by_src, count 10, seconds 900; classtype:attempted-admin; sid:2210003; rev:1;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"PASSWORD SPRAYING - HTTP multiple login failures"; http_stat_code; content:"401"; threshold:type both, track by_src, count 15, seconds 900; classtype:attempted-admin; sid:2210004; rev:1;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"PASSWORD SPRAYING - HTTPS multiple login failures"; ssl_cert_subject; content:"401"; threshold:type both, track by_src, count 15, seconds 900; classtype:attempted-admin; sid:2210005; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"PASSWORD SPRAYING - FTP multiple failed logins"; flow:to_server,established; content:"530 Login incorrect"; nocase; threshold:type both, track by_src, count 10, seconds 900; classtype:attempted-admin; sid:2210006; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:"PASSWORD SPRAYING - IMAP multiple failed logins"; flow:to_server,established; content:"authentication failed"; nocase; threshold:type both, track by_src, count 10, seconds 900; classtype:attempted-admin; sid:2210007; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 (msg:"PASSWORD SPRAYING - POP3 multiple failed logins"; flow:to_server,established; content:"-ERR login failed"; nocase; threshold:type both, track by_src, count 10, seconds 900; classtype:attempted-admin; sid:2210008; rev:1;)
