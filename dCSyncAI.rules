alert tcp 192.168.1.0/24 any -> any 445 (msg:"DCSYNC-BASE: DsGetNCChanges replication request"; content:"DsGetNCChanges"; threshold:type both,track by_src,count 1,seconds 60; flowbits:set,dcsync.replication.request; flowbits:noalert; classtype:attempted-admin; sid:10001001; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"DCSYNC-BASE: Directory replication service access"; content:"MS-DRSR"; threshold:type both,track by_src,count 1,seconds 45; flowbits:set,dcsync.drsr.access; flowbits:noalert; classtype:attempted-admin; sid:10001002; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"DCSYNC-BASE: RPC directory replication calls"; content:"|05 00|"; content:"drsuapi"; distance:0; within:100; threshold:type both,track by_src,count 2,seconds 60; flowbits:set,dcsync.rpc.drsuapi; flowbits:noalert; classtype:attempted-admin; sid:10001003; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"DCSYNC-BASE: Unauthorized replication from non-DC"; content:"DsGetNCChanges"; threshold:type both,track by_src,count 1,seconds 30; flowbits:set,dcsync.unauthorized.repl; flowbits:noalert; classtype:attempted-admin; sid:10001004; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"DCSYNC-BASE: LDAP search for replication metadata"; content:"replPropertyMetaData"; threshold:type both,track by_src,count 2,seconds 45; flowbits:set,dcsync.ldap.metadata; flowbits:noalert; classtype:attempted-admin; sid:10001005; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"DCSYNC-ADV: Mimikatz DCSync signature"; content:"lsadump::dcsync"; nocase; threshold:type both,track by_src,count 1,seconds 30; flowbits:set,dcsync.mimikatz.sig; flowbits:noalert; classtype:attempted-admin; sid:10001006; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"DCSYNC-ADV: Hash extraction via replication"; content:"unicodePwd"; threshold:type both,track by_src,count 1,seconds 40; flowbits:set,dcsync.hash.extraction; flowbits:noalert; classtype:attempted-admin; sid:10001007; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"DCSYNC-ADV: Krbtgt account replication"; content:"krbtgt"; content:"DsGetNCChanges"; distance:0; within:200; threshold:type both,track by_src,count 1,seconds 30; flowbits:set,dcsync.krbtgt.repl; flowbits:noalert; classtype:attempted-admin; sid:10001008; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"DCSYNC-ADV: Administrative account targeting"; content:"Administrator"; content:"DsGetNCChanges"; distance:0; within:200; threshold:type both,track by_src,count 1,seconds 30; flowbits:set,dcsync.admin.target; flowbits:noalert; classtype:attempted-admin; sid:10001009; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"DCSYNC-ADV: Full domain database replication"; content:"DsGetNCChanges"; content:"DC="; distance:0; within:150; threshold:type both,track by_src,count 1,seconds 45; flowbits:set,dcsync.full.domain; flowbits:noalert; classtype:attempted-admin; sid:10001010; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"DCSYNC-ADV: Suspicious replication timing"; content:"DsGetNCChanges"; detection_filter:track by_src,count 2,seconds 120; flowbits:set,dcsync.suspicious.timing; flowbits:noalert; classtype:attempted-admin; sid:10001011; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"COMBO-DCSYNC-BASIC: Replication request with DRSR access"; flowbits:isset,dcsync.replication.request; flowbits:isset,dcsync.drsr.access; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:2; sid:10002001; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"COMBO-DCSYNC-BASIC: Unauthorized replication with hash extraction"; flowbits:isset,dcsync.unauthorized.repl; flowbits:isset,dcsync.hash.extraction; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:2; sid:10002002; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"COMBO-DCSYNC-ADVANCED: Mimikatz DCSync attack"; flowbits:isset,dcsync.mimikatz.sig; flowbits:isset,dcsync.rpc.drsuapi; flowbits:isset,dcsync.hash.extraction; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:10002003; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"COMBO-DCSYNC-EXPERT: Complete domain compromise via DCSync"; flowbits:isset,dcsync.krbtgt.repl; flowbits:isset,dcsync.admin.target; flowbits:isset,dcsync.full.domain; flowbits:isset,dcsync.suspicious.timing; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:10002004; rev:1;)
