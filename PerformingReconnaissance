alert tcp any any -> any 389 (msg:"LDAP Recon: Usernames enumeration"; flow:established,to_server; content:"sAMAccountName"; nocase; dsize:>200; threshold:type both, track by_src, count 10, seconds 60; sid:101001; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Full Name / Display Name enumeration"; flow:established,to_server; content:"displayName"; nocase; dsize:>200; threshold:type both, track by_src, count 10, seconds 60; sid:101002; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Email address enumeration"; flow:established,to_server; content:"mail"; nocase; dsize:>200; threshold:type both, track by_src, count 10, seconds 60; sid:101003; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Account status enumeration"; flow:established,to_server; content:"userAccountControl"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:101004; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Password policies / pre-auth disabled"; flow:established,to_server; content:"msDS-UserPasswordExpiryTimeComputed"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:101005; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Privileged group enumeration"; flow:established,to_server; content:"(&(objectClass=group)(|(cn=Domain Admins)(cn=Enterprise Admins)))"; nocase; dsize:>300; threshold:type both, track by_src, count 5, seconds 60; sid:102001; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Group membership enumeration"; flow:established,to_server; content:"memberOf"; nocase; dsize:>200; threshold:type both, track by_src, count 10, seconds 60; sid:102002; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Nested group enumeration"; flow:established,to_server; content:"memberOf:1.2.840.113556.1.4.1941"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:102003; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Computer object enumeration"; flow:established,to_server; content:"objectClass=computer"; nocase; dsize:>200; threshold:type both, track by_src, count 10, seconds 60; sid:103001; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: OU enumeration"; flow:established,to_server; content:"organizationalUnit"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:104001; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Service account / SPN enumeration"; flow:established,to_server; content:"servicePrincipalName"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:105001; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Kerberos / Password policy enumeration"; flow:established,to_server; content:"msDS-UserPasswordExpiryTimeComputed"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:106001; rev:1;)
