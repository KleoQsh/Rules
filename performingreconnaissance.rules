alert tcp any any -> any 389 (msg:"LDAP Recon: Usernames enumeration"; flow:established,to_server; content:"sAMAccountName"; nocase; dsize:>200; threshold:type both, track by_src, count 10, seconds 60; sid:101001; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Full Name / Display Name enumeration"; flow:established,to_server; content:"displayName"; nocase; dsize:>200; threshold:type both, track by_src, count 10, seconds 60; sid:101002; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Email address enumeration"; flow:established,to_server; content:"mail"; nocase; dsize:>200; threshold:type both, track by_src, count 10, seconds 60; sid:101003; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Account status enumeration"; flow:established,to_server; content:"userAccountControl"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:101004; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Password policies / pre-auth disabled"; flow:established,to_server; content:"msDS-UserPasswordExpiryTimeComputed"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:101005; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Privileged group enumeration"; flow:established,to_server; content:"(&(objectClass=group)(|(cn=Domain Admins)(cn=Enterprise Admins)))"; nocase; dsize:>300; threshold:type both, track by_src, count 5, seconds 60; sid:102001; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Group membership enumeration"; flow:established,to_server; content:"memberOf"; nocase; dsize:>200; threshold:type both, track by_src, count 10, seconds 60; sid:102002; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Nested group enumeration"; flow:established,to_server; content:"memberOf:1.2.840.113556.1.4.1941"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:102003; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Computer object enumeration"; flow:established,to_server; content:"objectClass=computer"; nocase; dsize:>200; threshold:type both, track by_src, count 10, seconds 60; sid:103001; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: OU enumeration"; flow:established,to_server; content:"organizationalUnit"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:104001; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Service account / SPN enumeration"; flow:established,to_server; content:"servicePrincipalName"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:105001; rev:1;)
alert tcp any any -> any 389 (msg:"LDAP Recon: Kerberos / Password policy enumeration"; flow:established,to_server; content:"msDS-UserPasswordExpiryTimeComputed"; nocase; dsize:>200; threshold:type both, track by_src, count 5, seconds 60; sid:106001; rev:1;)
alert tcp any any -> any 445 (msg:"SMB Recon: Share enumeration"; flow:established,to_server; content:"\\PIPE\\srvsvc"; nocase; dsize:>50; threshold:type both, track by_src, count 5, seconds 60; sid:200001; rev:1;)
alert udp any any -> any 137 (msg:"NetBIOS Recon: Name query"; content:"NBTSTAT"; nocase; threshold:type both, track by_src, count 5, seconds 60; sid:200002; rev:1;)
alert udp any any -> any 138 (msg:"NetBIOS Recon: Broadcast query"; content:""; threshold:type both, track by_src, count 5, seconds 60; sid:200003; rev:1;)
alert icmp any any -> any any (msg:"ICMP Recon: Ping sweep"; itype:8; threshold:type both, track by_src, count 5, seconds 60; sid:300001; rev:1;)
alert tcp any any -> any any (msg:"TCP Recon: SYN scan"; flags:S; threshold:type both, track by_src, count 10, seconds 60; sid:400001; rev:1;)
alert tcp any any -> any any (msg:"TCP Recon: XMAS scan"; flags:FPU; threshold:type both, track by_src, count 5, seconds 60; sid:400002; rev:1;)
alert udp any any -> any 53 (msg:"DNS Recon: Zone transfer"; content:"AXFR"; nocase; threshold:type both, track by_src, count 1, seconds 60; sid:500001; rev:1;)
alert udp any any -> any 53 (msg:"DNS Recon: Excessive queries"; threshold:type both, track by_src, count 20, seconds 60; sid:500002; rev:1;)
alert tcp any any -> any 88 (msg:"Kerberos Recon: AS-REQ user enumeration"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 5, seconds 60; sid:600001; rev:1;)
alert udp any any -> any 88 (msg:"Kerberos Recon: TGS-REQ enumeration"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 5, seconds 60; sid:600002; rev:1;)
alert tcp any any -> any 3389 (msg:"RDP Recon: Host discovery"; flags:S; threshold:type both, track by_src, count 5, seconds 60; sid:700001; rev:1;)
