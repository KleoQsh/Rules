alert tcp 192.168.1.0/24 any -> 192.168.1.10 389 (msg:"LDAP SPN Enumeration Attempt from LAN"; flow:established,to_server; content:"servicePrincipalName"; nocase; detection_filter:track by_src,count 10,seconds 60; sid:200001; rev:1; classtype:attempted-recon;)
alert tcp !192.168.1.0/24 any -> 192.168.1.10 389 (msg:"LDAP SPN Enumeration Attempt from WAN"; flow:established,to_server; content:"servicePrincipalName"; nocase; detection_filter:track by_src,count 1,seconds 60; sid:200002; rev:1; classtype:attempted-recon;)
alert tcp 192.168.1.0/24 any -> 192.168.1.10 636 (msg:"Potential LDAPS SPN Enumeration from LAN - High Frequency"; flow:established,to_server; detection_filter:track by_src,count 20,seconds 60; sid:200003; rev:1; classtype:attempted-recon;)
alert tcp 192.168.1.0/24 any -> 192.168.1.10 [135,139,445] (msg:"SPN Enumeration via RPC/SMB from LAN"; flow:established,to_server; detection_filter:track by_src,count 5,seconds 60; sid:200004; rev:1; classtype:attempted-recon;)
alert tcp !192.168.1.0/24 any -> 192.168.1.10 [135,139,445] (msg:"Suspicious RPC/SMB SPN Enumeration from WAN"; flow:established,to_server; detection_filter:track by_src,count 1,seconds 60; sid:200005; rev:1; classtype:attempted-recon;)
