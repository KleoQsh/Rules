alert tcp 192.168.1.0/24 any -> 192.168.1.10 389 (msg:"LDAP SPN Enumeration Attempt from LAN"; flow:established,to_server; content:"servicePrincipalName"; nocase; detection_filter:track by_src,count 10,seconds 60; sid:200001; rev:1; classtype:attempted-recon;)
alert tcp !192.168.1.0/24 any -> 192.168.1.10 389 (msg:"LDAP SPN Enumeration Attempt from WAN"; flow:established,to_server; content:"servicePrincipalName"; nocase; detection_filter:track by_src,count 1,seconds 60; sid:200002; rev:1; classtype:attempted-recon;)
alert tcp 192.168.1.0/24 any -> 192.168.1.10 636 (msg:"Potential LDAPS SPN Enumeration from LAN - High Frequency"; flow:established,to_server; detection_filter:track by_src,count 20,seconds 60; sid:200003; rev:1; classtype:attempted-recon;)
alert tcp 192.168.1.0/24 any -> 192.168.1.10 [135,139,445] (msg:"SPN Enumeration via RPC/SMB from LAN"; flow:established,to_server; detection_filter:track by_src,count 5,seconds 60; sid:200004; rev:1; classtype:attempted-recon;)
alert tcp !192.168.1.0/24 any -> 192.168.1.10 [135,139,445] (msg:"Suspicious RPC/SMB SPN Enumeration from WAN"; flow:established,to_server; detection_filter:track by_src,count 1,seconds 60; sid:200005; rev:1; classtype:attempted-recon;)
alert tcp 192.168.1.0/24 any -> 192.168.1.10 636 (msg:"LDAPS SPN Enumeration - Excessive Bind Attempts"; flow:established,to_server; detection_filter:track by_src,count 30,seconds 60; sid:200006; rev:1; classtype:attempted-recon;)
alert tcp 192.168.1.0/24 any -> 192.168.1.10 636 (msg:"LDAPS SPN Enumeration - High Search Frequency"; flow:established,to_server; detection_filter:track by_src,count 50,seconds 120; sid:200007; rev:1; classtype:attempted-recon;)
alert tcp !192.168.1.0/24 any -> 192.168.1.10 636 (msg:"Suspicious LDAPS Access from Non-Domain Host"; flow:established,to_server; detection_filter:track by_src,count 1,seconds 60; sid:200008; rev:1; classtype:attempted-recon;)
alert tcp 192.168.1.0/24 any -> 192.168.1.10 636 (msg:"LDAPS SPN Enumeration - Off-Hours Activity"; flow:established,to_server; detection_filter:track by_src,count 10,seconds 60; time:!daytime; sid:200009; rev:1; classtype:attempted-recon;)
alert tcp 192.168.1.0/24 any -> [192.168.1.10,192.168.1.11,192.168.1.12] 636 (msg:"LDAPS SPN Enumeration Across Multiple DCs"; flow:established,to_server; detection_filter:track by_src,count 3,seconds 120; sid:200010; rev:1; classtype:attempted-recon;)
