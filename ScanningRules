alert arp any any -> any any (msg:"SCAN:L2 Excessive ARP requests (possible scanning/recon)"; threshold:type both, track by_src, count 8, seconds 12; sid:2300001; rev:1;)
alert arp any any -> any any (msg:"SCAN:L2 Gratuitous ARP bursts (mass-probing)"; threshold:type both, track by_src, count 6, seconds 8; sid:2300002; rev:1;)
alert ether any any -> any any (msg:"SCAN:L2 Many distinct MAC destinations from single source (sweep)"; threshold:type both, track by_src, count 10, seconds 60; sid:2300003; rev:1;)
alert ip any any -> any any (msg:"SCAN:L3 Ping sweep - many ICMP Echo Requests from host"; itype:8; threshold:type both, track by_src, count 12, seconds 30; sid:2300011; rev:1;)
alert ip any any -> any any (msg:"SCAN:L3 Many distinct destination IPs contacted by single source (sweep)"; threshold:type both, track by_src, count 15, seconds 60; sid:2300012; rev:1;)
alert ip any any -> any any (msg:"SCAN:L3 Rapid distributed probes from many sources (possible coordinated scan)"; threshold:type both, track by_dst, count 10, seconds 30; sid:2300013; rev:1;)
alert ip any any -> any any (msg:"SCAN:L3 Fragmentation scanning heuristic - many small fragments"; dsize:<200; threshold:type both, track by_src, count 12, seconds 40; sid:2300014; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L4 SYN scan - many SYNs to multiple ports"; flow:to_server; flags:S; threshold:type both, track by_src, count 12, seconds 25; sid:2300021; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L4 Connect-scan - many full connects then RST"; flow:to_server,from_server; flags:SA; threshold:type both, track by_src, count 8, seconds 30; sid:2300022; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L4 NULL scan - TCP with no flags"; flow:stateless; flags:0; threshold:type both, track by_src, count 6, seconds 40; sid:2300023; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L4 FIN scan - FIN-only packets to many ports"; flow:stateless; flags:F; threshold:type both, track by_src, count 6, seconds 40; sid:2300024; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L4 XMAS scan - FIN/PSH/URG flags"; flow:stateless; flags:FPU; threshold:type both, track by_src, count 6, seconds 40; sid:2300025; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L4 ACK/Window scan - many ACK packets to multiple ports"; flow:stateless; flags:A; threshold:type both, track by_src, count 10, seconds 40; sid:2300026; rev:1;)
alert udp any any -> any any (msg:"SCAN:L4 UDP scan heuristic - many UDP probes to different ports"; threshold:type both, track by_src, count 20, seconds 60; sid:2300027; rev:1;)
alert icmp any any -> any any (msg:"SCAN:L4 UDP scan - many ICMP port unreachable responses"; itype:3; threshold:type both, track by_dst, count 8, seconds 40; sid:2300028; rev:1;)
alert ip any any -> any any (msg:"SCAN:L4 Many small TCP fragments - possible fragmentation scan"; dsize:<120; threshold:type both, track by_src, count 10, seconds 60; sid:2300029; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L5 Many half-open TCP sessions (SYN w/o completion)"; flow:to_server; flags:S; threshold:type both, track by_src, count 15, seconds 60; sid:2300031; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L5 Many short sessions (connect & immediate close)"; flow:to_server,from_server; threshold:type both, track by_src, count 12, seconds 40; sid:2300032; rev:1;)
alert udp any any -> any any (msg:"SCAN:L5 Repeated UDP flows from single source to many ports (session-like)"; threshold:type both, track by_src, count 25, seconds 120; sid:2300033; rev:1;)
alert tcp any any -> any [21,22,23,25,80,443,3389] (msg:"SCAN:L6 Banner grab / service probe - many requests to common service ports"; flow:to_server; threshold:type both, track by_src, count 12, seconds 60; sid:2300041; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L6 Many tiny TCP payloads to many ports (probe heuristics)"; dsize:<100; threshold:type both, track by_src, count 20, seconds 60; sid:2300042; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L6 Repeated HTTP GETs to many hosts (crawler vs scanner)"; content:"GET "; depth:4; nocase; threshold:type both, track by_src, count 30, seconds 120; sid:2300043; rev:1;)
alert tcp any any -> any 80 (msg:"SCAN:L7 HTTP vhost scanning - many Host headers to same server"; flow:to_server; content:"Host: "; depth:6; nocase; threshold:type both, track by_src, count 20, seconds 120; sid:2300051; rev:1;)
alert tcp any any -> any 22 (msg:"SCAN:L7 SSH brute-probing-like behavior - many Banner requests/auth attempts"; flow:to_server; threshold:type both, track by_src, count 15, seconds 120; sid:2300052; rev:1;)
alert tcp any any -> any 3389 (msg:"SCAN:L7 RDP scanning - many RDP connect attempts to multiple hosts"; flow:to_server; threshold:type both, track by_src, count 8, seconds 90; sid:2300053; rev:1;)
alert tcp any any -> any any (msg:"SCAN:L7 Many distinct destination ports contacted while carrying no application payload (probing)"; dsize:<=0; threshold:type both, track by_src, count 20, seconds 60; sid:2300054; rev:1;)
