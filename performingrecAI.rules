alert tcp 192.168.1.0/24 any -> any 445 (msg:"RECON-BASE: SMB share enumeration"; content:"IPC$"; threshold:type both,track by_src,count 4,seconds 60; flowbits:set,recon.smb.shares; flowbits:noalert; classtype:attempted-recon; sid:9001001; rev:1;)
alert tcp 192.168.1.0/24 any -> any [135,445] (msg:"RECON-BASE: RPC endpoint enumeration"; content:"|05 00|"; threshold:type both,track by_src,count 6,seconds 45; flowbits:set,recon.rpc.endpoints; flowbits:noalert; classtype:attempted-recon; sid:9001002; rev:1;)
alert tcp 192.168.1.0/24 any -> any 139 (msg:"RECON-BASE: NetBIOS name enumeration"; content:"|00 00 00 15|"; threshold:type both,track by_src,count 5,seconds 50; flowbits:set,recon.netbios.names; flowbits:noalert; classtype:attempted-recon; sid:9001003; rev:1;)
alert udp 192.168.1.0/24 any -> any 137 (msg:"RECON-BASE: NetBIOS name queries"; content:"|01 10 00 01|"; threshold:type both,track by_src,count 8,seconds 60; flowbits:set,recon.netbios.queries; flowbits:noalert; classtype:attempted-recon; sid:9001004; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"RECON-BASE: LDAP directory enumeration"; content:"objectClass"; threshold:type both,track by_src,count 10,seconds 90; flowbits:set,recon.ldap.directory; flowbits:noalert; classtype:attempted-recon; sid:9001005; rev:1;)
alert tcp 192.168.1.0/24 any -> any 53 (msg:"RECON-BASE: DNS zone transfer attempts"; content:"|00 00 fc 00 01|"; threshold:type both,track by_src,count 2,seconds 45; flowbits:set,recon.dns.zone; flowbits:noalert; classtype:attempted-recon; sid:9001006; rev:1;)
alert udp 192.168.1.0/24 any -> any 161 (msg:"RECON-BASE: SNMP community enumeration"; content:"|30|"; threshold:type both,track by_src,count 6,seconds 60; flowbits:set,recon.snmp.community; flowbits:noalert; classtype:attempted-recon; sid:9001007; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"RECON-ADV: Service version enumeration"; content:"Server:"; threshold:type both,track by_src,count 8,seconds 120; flowbits:set,recon.service.version; flowbits:noalert; classtype:attempted-recon; sid:9001008; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"RECON-ADV: Operating system fingerprinting"; threshold:type both,track by_src,count 15,seconds 180; flowbits:set,recon.os.fingerprint; flowbits:noalert; classtype:attempted-recon; sid:9001009; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"RECON-ADV: Domain controller enumeration"; content:"SYSVOL"; threshold:type both,track by_src,count 2,seconds 45; flowbits:set,recon.dc.enum; flowbits:noalert; classtype:attempted-recon; sid:9001010; rev:1;)
alert tcp 192.168.1.0/24 any -> any 389 (msg:"RECON-ADV: Active Directory schema query"; content:"schema"; threshold:type both,track by_src,count 3,seconds 60; flowbits:set,recon.ad.schema; flowbits:noalert; classtype:attempted-recon; sid:9001011; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"RECON-ADV: Network topology mapping"; threshold:type both,track by_src,count 25,seconds 300; flowbits:set,recon.network.topology; flowbits:noalert; classtype:attempted-recon; sid:9001012; rev:1;)
alert tcp 192.168.1.0/24 any -> any 445 (msg:"RECON-ADV: Trust relationship enumeration"; content:"trusted"; threshold:type both,track by_src,count 2,seconds 50; flowbits:set,recon.trust.enum; flowbits:noalert; classtype:attempted-recon; sid:9001013; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"COMBO-RECON-BASIC: SMB and NetBIOS enumeration"; flowbits:isset,recon.smb.shares; flowbits:isset,recon.netbios.names; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:2; sid:9002001; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"COMBO-RECON-BASIC: LDAP and DNS reconnaissance"; flowbits:isset,recon.ldap.directory; flowbits:isset,recon.dns.zone; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:2; sid:9002002; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"COMBO-RECON-ADVANCED: Comprehensive network reconnaissance"; flowbits:isset,recon.service.version; flowbits:isset,recon.os.fingerprint; flowbits:isset,recon.network.topology; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:9002003; rev:1;)
alert tcp 192.168.1.0/24 any -> any any (msg:"COMBO-RECON-EXPERT: Advanced AD reconnaissance campaign"; flowbits:isset,recon.dc.enum; flowbits:isset,recon.ad.schema; flowbits:isset,recon.trust.enum; flowbits:isset,recon.rpc.endpoints; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-recon; priority:1; sid:9002004; rev:1;)
