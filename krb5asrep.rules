alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: TGS Request for Service Account"; content:"|a0 03 02 01 05|"; content:"|a1 03 02 01 16|"; threshold:type both,track by_src,count 3,seconds 60; flowbits:set,kerb.tgs.request; flowbits:noalert; classtype:attempted-admin; sid:5001001; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: RC4 Encryption in TGS Request"; content:"|a0 03 02 01 05|"; content:"|17|"; distance:0; within:50; threshold:type both,track by_src,count 2,seconds 45; flowbits:set,kerb.rc4.request; flowbits:noalert; classtype:attempted-admin; sid:5001002; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: Multiple Service Ticket Requests"; content:"krbtgt"; threshold:type both,track by_src,count 5,seconds 90; flowbits:set,kerb.multiple.tgs; flowbits:noalert; classtype:attempted-admin; sid:5001003; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: Service Principal Enumeration"; content:"HTTP/"; threshold:type both,track by_src,count 4,seconds 60; flowbits:set,kerb.spn.enum; flowbits:noalert; classtype:attempted-admin; sid:5001004; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: Unusual Service Ticket Timing"; content:"|a0 03 02 01 05|"; detection_filter:track by_src,count 3,seconds 30; flowbits:set,kerb.timing.anomaly; flowbits:noalert; classtype:attempted-admin; sid:5001005; rev:2;)
alert tcp $HOME_NET any -> any 389 (msg:"KERB-BASE: LDAP SPN Query for Kerberoasting"; content:"servicePrincipalName"; threshold:type both,track by_src,count 3,seconds 45; flowbits:set,kerb.ldap.spn; flowbits:noalert; classtype:attempted-admin; sid:5001006; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: Automated Kerberoasting Tool Signature"; content:"|a0 03 02 01 05|"; content:"|a1 03 02 01 16|"; content:"|a2|"; distance:0; within:100; threshold:type both,track by_src,count 2,seconds 30; flowbits:set,kerb.automated.tool; flowbits:noalert; classtype:attempted-admin; sid:5001007; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: Cross-Domain TGS Requests"; content:"krbtgt"; content:"@"; distance:0; within:50; threshold:type both,track by_src,count 2,seconds 60; flowbits:set,kerb.cross.domain; flowbits:noalert; classtype:attempted-admin; sid:5001008; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: High-Privilege Service Targeting"; content:"HOST/"; threshold:type both,track by_src,count 2,seconds 45; flowbits:set,kerb.high.priv; flowbits:noalert; classtype:attempted-admin; sid:5001009; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: Suspicious TGS Request Volume"; threshold:type both,track by_src,count 10,seconds 120; flowbits:set,kerb.high.volume; flowbits:noalert; classtype:attempted-admin; sid:5001010; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: Repeated Failed TGS Requests"; content:"|a0 03 02 01 05|"; detection_filter:track by_src,count 5,seconds 60; flowbits:set,kerb.failed.tgs; flowbits:noalert; classtype:attempted-admin; sid:5001011; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: Unusual TGS Request Size"; dsize:>1000; threshold:type both,track by_src,count 3,seconds 60; flowbits:set,kerb.large.tgs; flowbits:noalert; classtype:attempted-admin; sid:5001012; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: TGS Request with No Pre-Auth"; content:"|a0 03 02 01 05|"; content:"|a1 03 02 01 16|"; content:"|a2 03 02 01 17|"; distance:0; within:100; threshold:type both,track by_src,count 2,seconds 30; flowbits:set,kerb.no.preauth; flowbits:noalert; classtype:attempted-admin; sid:5001013; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: TGS Request with Weak Encryption"; content:"|a0 03 02 01 05|"; content:"|17|"; distance:0; within:50; threshold:type both,track by_src,count 2,seconds 45; flowbits:set,kerb.weak.enc; flowbits:noalert; classtype:attempted-admin; sid:5001014; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"KERB-BASE: TGS Request with Unusual SPN"; content:"|a0 03 02 01 05|"; content:"|a1 03 02 01 16|"; content:"|a2 03 02 01 17|"; distance:0; within:100; threshold:type both,track by_src,count 2,seconds 30; flowbits:set,kerb.unusual.spn; flowbits:noalert; classtype:attempted-admin; sid:5001015; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: TGS and SPN Enumeration"; flowbits:isset,kerb.tgs.request; flowbits:isset,kerb.ldap.spn; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002001; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: RC4 and Multiple Requests"; flowbits:isset,kerb.rc4.request; flowbits:isset,kerb.multiple.tgs; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002002; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Automated Tool and SPN Enum"; flowbits:isset,kerb.automated.tool; flowbits:isset,kerb.spn.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002003; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Cross-Domain and High-Priv"; flowbits:isset,kerb.cross.domain; flowbits:isset,kerb.high.priv; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002004; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: High Volume and Failed TGS"; flowbits:isset,kerb.high.volume; flowbits:isset,kerb.failed.tgs; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002005; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Large TGS and Weak Encryption"; flowbits:isset,kerb.large.tgs; flowbits:isset,kerb.weak.enc; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002006; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: No Pre-Auth and Unusual SPN"; flowbits:isset,kerb.no.preauth; flowbits:isset,kerb.unusual.spn; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002007; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Timing Anomaly and Automated Tool"; flowbits:isset,kerb.timing.anomaly; flowbits:isset,kerb.automated.tool; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002008; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: SPN Enum and High-Priv"; flowbits:isset,kerb.spn.enum; flowbits:isset,kerb.high.priv; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002009; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Multiple TGS and RC4"; flowbits:isset,kerb.multiple.tgs; flowbits:isset,kerb.rc4.request; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002010; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: LDAP SPN and TGS Request"; flowbits:isset,kerb.ldap.spn; flowbits:isset,kerb.tgs.request; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002011; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Cross-Domain and SPN Enum"; flowbits:isset,kerb.cross.domain; flowbits:isset,kerb.spn.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002012; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: High Volume and Timing Anomaly"; flowbits:isset,kerb.high.volume; flowbits:isset,kerb.timing.anomaly; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002013; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Failed TGS and Weak Encryption"; flowbits:isset,kerb.failed.tgs; flowbits:isset,kerb.weak.enc; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002014; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Large TGS and No Pre-Auth"; flowbits:isset,kerb.large.tgs; flowbits:isset,kerb.no.preauth; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002015; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Unusual SPN and Automated Tool"; flowbits:isset,kerb.unusual.spn; flowbits:isset,kerb.automated.tool; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002016; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: High-Priv and RC4"; flowbits:isset,kerb.high.priv; flowbits:isset,kerb.rc4.request; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002017; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Multiple TGS and SPN Enum"; flowbits:isset,kerb.multiple.tgs; flowbits:isset,kerb.spn.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002018; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Cross-Domain and RC4"; flowbits:isset,kerb.cross.domain; flowbits:isset,kerb.rc4.request; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002019; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: LDAP SPN and High-Priv"; flowbits:isset,kerb.ldap.spn; flowbits:isset,kerb.high.priv; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002020; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Timing Anomaly and Weak Encryption"; flowbits:isset,kerb.timing.anomaly; flowbits:isset,kerb.weak.enc; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002021; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Failed TGS and Unusual SPN"; flowbits:isset,kerb.failed.tgs; flowbits:isset,kerb.unusual.spn; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002022; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Large TGS and SPN Enum"; flowbits:isset,kerb.large.tgs; flowbits:isset,kerb.spn.enum; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002023; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: No Pre-Auth and High Volume"; flowbits:isset,kerb.no.preauth; flowbits:isset,kerb.high.volume; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002024; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Automated Tool and High-Priv"; flowbits:isset,kerb.automated.tool; flowbits:isset,kerb.high.priv; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002025; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Multiple TGS and Timing Anomaly"; flowbits:isset,kerb.multiple.tgs; flowbits:isset,kerb.timing.anomaly; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002026; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Cross-Domain and```plaintext
flowbits:isset,kerb.cross.domain; flowbits:isset,kerb.timing.anomaly; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002027; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: LDAP SPN and Automated Tool"; flowbits:isset,kerb.ldap.spn; flowbits:isset,kerb.automated.tool; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002028; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: High Volume and RC4"; flowbits:isset,kerb.high.volume; flowbits:isset,kerb.rc4.request; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002029; rev:2;)
alert tcp $HOME_NET any -> any 88 (msg:"COMBO-KERB: Failed TGS and High-Priv"; flowbits:isset,kerb.failed.tgs; flowbits:isset,kerb.high.priv; threshold:type limit,track by_src,count 1,seconds 300; classtype:attempted-admin; priority:1; sid:5002030; rev:2;)
