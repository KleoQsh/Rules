alert tcp any any -> <DC_IP> 88 (msg:"Kerberos AS-REP Roasting - Single User"; content:"krb5asrep"; nocase; threshold:type both, track by_src, count 1, seconds 60; sid:800002; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberos AS-REQ user enumeration"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 3, seconds 60; sid:600101; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberos TGS-REQ SPN request"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 3, seconds 60; sid:600102; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: multiple SPN requests"; content:"servicePrincipalName"; nocase; threshold:type both, track by_src, count 3, seconds 60; sid:600103; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: large AS-REQ packet"; dsize:>250; content:"Kerberos"; nocase; threshold:type both, track by_src, count 3, seconds 60; sid:600104; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: large TGS-REQ packet"; dsize:>250; content:"Kerberos"; nocase; threshold:type both, track by_src, count 3, seconds 60; sid:600105; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: AS-REQ flood"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 6, seconds 60; sid:600106; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: TGS-REQ flood"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 6, seconds 60; sid:600107; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: SPN enumeration attempt"; content:"servicePrincipalName"; nocase; threshold:type both, track by_src, count 2, seconds 30; sid:600108; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: multiple TGS-REQs to same SPN"; content:"servicePrincipalName"; nocase; threshold:type both, track by_src, count 3, seconds 60; sid:600109; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: repeated AS-REQs from single host"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 4, seconds 60; sid:600110; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: unusual Kerberos packet size"; dsize:>300; content:"Kerberos"; nocase; threshold:type both, track by_src, count 2, seconds 60; sid:600111; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: AS-REQ to high-privilege account"; content:"Admin"; nocase; threshold:type both, track by_src, count 2, seconds 60; sid:600112; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: TGS-REQ to high-privilege SPN"; content:"Admin"; nocase; threshold:type both, track by_src, count 2, seconds 60; sid:600113; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: multiple SPN requests in short time"; content:"servicePrincipalName"; nocase; threshold:type both, track by_src, count 5, seconds 60; sid:600114; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: AS-REQ outside normal hours"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 2, seconds 300; sid:600115; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: TGS-REQ outside normal hours"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 2, seconds 300; sid:600116; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: unusual AS-REQ sequence"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 4, seconds 60; sid:600117; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: unusual TGS-REQ sequence"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 4, seconds 60; sid:600118; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: repeated ticket requests for same user"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 3, seconds 60; sid:600119; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: multiple AS-REQs for SPN users"; content:"servicePrincipalName"; nocase; threshold:type both, track by_src, count 3, seconds 60; sid:600120; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: TGS-REQ size anomaly"; dsize:>300; content:"Kerberos"; nocase; threshold:type both, track by_src, count 2, seconds 60; sid:600121; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: AS-REQ size anomaly"; dsize:>300; content:"Kerberos"; nocase; threshold:type both, track by_src, count 2, seconds 60; sid:600122; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: AS-REQ/TGS-REQ spike"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 5, seconds 60; sid:600123; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: repeated SPN requests over time"; content:"servicePrincipalName"; nocase; threshold:type both, track by_src, count 4, seconds 120; sid:600124; rev:1;)
alert tcp 192.168.1.0/24 any -> 192.168.1.101 88 (msg:"Kerberoasting: AS-REQ to unusual accounts"; content:"Kerberos"; nocase; threshold:type both, track by_src, count 2, seconds 120; sid:600125; rev:1;)
